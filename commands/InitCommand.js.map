{"version":3,"sources":["../../src/commands/InitCommand.ts"],"names":[],"mappings":"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","file":"InitCommand.js","sourcesContent":["import { CommandUtils } from \"./CommandUtils\";\r\nimport { ObjectLiteral } from \"../common/ObjectLiteral\";\r\nimport * as path from \"path\";\r\nimport * as yargs from \"yargs\";\r\nimport chalk from \"chalk\";\r\nimport { exec } from \"child_process\";\r\nimport { TypeORMError } from \"../error/TypeORMError\";\r\nimport { PlatformTools } from \"../platform/PlatformTools\";\r\n\r\n/**\r\n * Generates a new project with TypeORM.\r\n */\r\nexport class InitCommand implements yargs.CommandModule {\r\n    command = \"init\";\r\n    describe = \"Generates initial TypeORM project structure. \" +\r\n        \"If name specified then creates files inside directory called as name. \" +\r\n        \"If its not specified then creates files inside current directory.\";\r\n\r\n    builder(args: yargs.Argv) {\r\n        return args\r\n            .option(\"c\", {\r\n                alias: \"connection\",\r\n                default: \"default\",\r\n                describe: \"Name of the connection on which to run a query\"\r\n            })\r\n            .option(\"n\", {\r\n                alias: \"name\",\r\n                describe: \"Name of the project directory.\"\r\n            })\r\n            .option(\"db\", {\r\n                alias: \"database\",\r\n                describe: \"Database type you'll use in your project.\"\r\n            })\r\n            .option(\"express\", {\r\n                describe: \"Indicates if express should be included in the project.\"\r\n            })\r\n            .option(\"docker\", {\r\n                describe: \"Set to true if docker-compose must be generated as well. False by default.\"\r\n            })\r\n            .option(\"pm\", {\r\n                alias: \"manager\",\r\n                choices: [\"npm\", \"yarn\"],\r\n                default: \"npm\",\r\n                describe: \"Install packages, expected values are npm or yarn.\"\r\n            })\r\n            .option(\"ms\", {\r\n                alias: \"module\",\r\n                choices: [\"commonjs\", \"esm\"],\r\n                default: \"commonjs\",\r\n                describe: \"Module system to use for project, expected values are commonjs or esm.\"\r\n            });\r\n    }\r\n\r\n    async handler(args: yargs.Arguments) {\r\n        try {\r\n            const database: string = args.database as any || \"mysql\";\r\n            const isExpress = args.express !== undefined ? true : false;\r\n            const isDocker = args.docker !== undefined ? true : false;\r\n            const basePath = process.cwd() + (args.name ? (\"/\" + args.name) : \"\");\r\n            const projectName = args.name ? path.basename(args.name as any) : undefined;\r\n            const installNpm = args.pm === \"yarn\" ? false : true;\r\n            const projectIsEsm = args.ms === \"esm\";\r\n            await CommandUtils.createFile(basePath + \"/package.json\", InitCommand.getPackageJsonTemplate(projectName, projectIsEsm), false);\r\n            if (isDocker)\r\n                await CommandUtils.createFile(basePath + \"/docker-compose.yml\", InitCommand.getDockerComposeTemplate(database), false);\r\n            await CommandUtils.createFile(basePath + \"/.gitignore\", InitCommand.getGitIgnoreFile());\r\n            await CommandUtils.createFile(basePath + \"/README.md\", InitCommand.getReadmeTemplate({ docker: isDocker }), false);\r\n            await CommandUtils.createFile(basePath + \"/tsconfig.json\", InitCommand.getTsConfigTemplate(projectIsEsm));\r\n            await CommandUtils.createFile(basePath + \"/ormconfig.json\", InitCommand.getOrmConfigTemplate(database));\r\n            await CommandUtils.createFile(basePath + \"/src/entity/User.ts\", InitCommand.getUserEntityTemplate(database));\r\n            await CommandUtils.createFile(basePath + \"/src/index.ts\", InitCommand.getAppIndexTemplate(isExpress, projectIsEsm));\r\n            await CommandUtils.createDirectories(basePath + \"/src/migration\");\r\n\r\n            // generate extra files for express application\r\n            if (isExpress) {\r\n                await CommandUtils.createFile(basePath + \"/src/routes.ts\", InitCommand.getRoutesTemplate(projectIsEsm));\r\n                await CommandUtils.createFile(basePath + \"/src/controller/UserController.ts\", InitCommand.getControllerTemplate(projectIsEsm));\r\n            }\r\n\r\n            const packageJsonContents = await CommandUtils.readFile(basePath + \"/package.json\");\r\n            await CommandUtils.createFile(basePath + \"/package.json\", InitCommand.appendPackageJson(packageJsonContents, database, isExpress, projectIsEsm));\r\n\r\n            if (args.name) {\r\n                console.log(chalk.green(`Project created inside ${chalk.blue(basePath)} directory.`));\r\n\r\n            } else {\r\n                console.log(chalk.green(`Project created inside current directory.`));\r\n            }\r\n\r\n            if (args.pm && installNpm) {\r\n                await InitCommand.executeCommand(\"npm install\", basePath);\r\n            } else {\r\n                await InitCommand.executeCommand(\"yarn install\", basePath);\r\n            }\r\n\r\n        } catch (err) {\r\n            PlatformTools.logCmdErr(\"Error during project initialization:\", err);\r\n            process.exit(1);\r\n        }\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Protected Static Methods\r\n    // -------------------------------------------------------------------------\r\n\r\n    protected static executeCommand(command: string, cwd: string) {\r\n        return new Promise<string>((ok, fail) => {\r\n            exec(command, {cwd}, (error: any, stdout: any, stderr: any) => {\r\n                if (stdout) return ok(stdout);\r\n                if (stderr) return fail(stderr);\r\n                if (error) return fail(error);\r\n                ok(\"\");\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the ormconfig file.\r\n     */\r\n    protected static getOrmConfigTemplate(database: string): string {\r\n        const options: ObjectLiteral = {};\r\n        switch (database) {\r\n            case \"mysql\":\r\n                Object.assign(options, {\r\n                    type: \"mysql\",\r\n                    host: \"localhost\",\r\n                    port: 3306,\r\n                    username: \"test\",\r\n                    password: \"test\",\r\n                    database: \"test\",\r\n                });\r\n                break;\r\n            case \"mariadb\":\r\n                Object.assign(options, {\r\n                    type: \"mariadb\",\r\n                    host: \"localhost\",\r\n                    port: 3306,\r\n                    username: \"test\",\r\n                    password: \"test\",\r\n                    database: \"test\",\r\n                });\r\n                break;\r\n            case \"sqlite\":\r\n                Object.assign(options, {\r\n                    type: \"sqlite\",\r\n                    \"database\": \"database.sqlite\",\r\n                });\r\n                break;\r\n            case \"better-sqlite3\":\r\n                Object.assign(options, {\r\n                    type: \"better-sqlite3\",\r\n                    \"database\": \"database.sqlite\",\r\n                });\r\n                break;\r\n            case \"postgres\":\r\n                Object.assign(options, {\r\n                    \"type\": \"postgres\",\r\n                    \"host\": \"localhost\",\r\n                    \"port\": 5432,\r\n                    \"username\": \"test\",\r\n                    \"password\": \"test\",\r\n                    \"database\": \"test\",\r\n                });\r\n                break;\r\n            case \"cockroachdb\":\r\n                Object.assign(options, {\r\n                    \"type\": \"cockroachdb\",\r\n                    \"host\": \"localhost\",\r\n                    \"port\": 26257,\r\n                    \"username\": \"root\",\r\n                    \"password\": \"\",\r\n                    \"database\": \"defaultdb\",\r\n                });\r\n                break;\r\n            case \"mssql\":\r\n                Object.assign(options, {\r\n                    \"type\": \"mssql\",\r\n                    \"host\": \"localhost\",\r\n                    \"username\": \"sa\",\r\n                    \"password\": \"Admin12345\",\r\n                    \"database\": \"tempdb\",\r\n                });\r\n                break;\r\n            case \"oracle\":\r\n                Object.assign(options, {\r\n                    \"type\": \"oracle\",\r\n                    \"host\": \"localhost\",\r\n                    \"username\": \"system\",\r\n                    \"password\": \"oracle\",\r\n                    \"port\": 1521,\r\n                    \"sid\": \"xe.oracle.docker\",\r\n                });\r\n                break;\r\n            case \"mongodb\":\r\n                Object.assign(options, {\r\n                    \"type\": \"mongodb\",\r\n                    \"database\": \"test\",\r\n                });\r\n                break;\r\n        }\r\n        Object.assign(options, {\r\n            synchronize: true,\r\n            logging: false,\r\n            entities: [\r\n                \"src/entity/**/*.ts\"\r\n            ],\r\n            migrations: [\r\n                \"src/migration/**/*.ts\"\r\n            ],\r\n            subscribers: [\r\n                \"src/subscriber/**/*.ts\"\r\n            ],\r\n            cli: {\r\n                entitiesDir: \"src/entity\",\r\n                migrationsDir: \"src/migration\",\r\n                subscribersDir: \"src/subscriber\"\r\n            }\r\n        });\r\n        return JSON.stringify(options, undefined, 3);\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the ormconfig file.\r\n     */\r\n    protected static getTsConfigTemplate(esmModule: boolean): string {\r\n        if (esmModule)\r\n            return JSON.stringify({\r\n                compilerOptions: {\r\n                    lib: [\"es2021\"],\r\n                    target: \"es2021\",\r\n                    module: \"es2022\",\r\n                    moduleResolution: \"node\",\r\n                    allowSyntheticDefaultImports: true,\r\n                    outDir: \"./build\",\r\n                    emitDecoratorMetadata: true,\r\n                    experimentalDecorators: true,\r\n                    sourceMap: true\r\n                }\r\n            }\r\n            , undefined, 3);\r\n        else\r\n            return JSON.stringify({\r\n                compilerOptions: {\r\n                    lib: [\"es5\", \"es6\"],\r\n                    target: \"es5\",\r\n                    module: \"commonjs\",\r\n                    moduleResolution: \"node\",\r\n                    outDir: \"./build\",\r\n                    emitDecoratorMetadata: true,\r\n                    experimentalDecorators: true,\r\n                    sourceMap: true\r\n                }\r\n            }\r\n            , undefined, 3);\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the .gitignore file.\r\n     */\r\n    protected static getGitIgnoreFile(): string {\r\n        return `.idea/\r\n.vscode/\r\nnode_modules/\r\nbuild/\r\ntmp/\r\ntemp/`;\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the user entity.\r\n     */\r\n    protected static getUserEntityTemplate(database: string): string {\r\n        return `import {Entity, ${ database === \"mongodb\" ? \"ObjectIdColumn, ObjectID\" : \"PrimaryGeneratedColumn\" }, Column} from \"typeorm\";\r\n\r\n@Entity()\r\nexport class User {\r\n\r\n    ${ database === \"mongodb\" ? \"@ObjectIdColumn()\" : \"@PrimaryGeneratedColumn()\" }\r\n    id: ${ database === \"mongodb\" ? \"ObjectID\" : \"number\" };\r\n\r\n    @Column()\r\n    firstName: string;\r\n\r\n    @Column()\r\n    lastName: string;\r\n\r\n    @Column()\r\n    age: number;\r\n\r\n}\r\n`;\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the route file (used when express is enabled).\r\n     */\r\n    protected static getRoutesTemplate(isEsm: boolean): string {\r\n        return `import {UserController} from \"./controller/UserController${isEsm ? \".js\" : \"\"}\";\r\n\r\nexport const Routes = [{\r\n    method: \"get\",\r\n    route: \"/users\",\r\n    controller: UserController,\r\n    action: \"all\"\r\n}, {\r\n    method: \"get\",\r\n    route: \"/users/:id\",\r\n    controller: UserController,\r\n    action: \"one\"\r\n}, {\r\n    method: \"post\",\r\n    route: \"/users\",\r\n    controller: UserController,\r\n    action: \"save\"\r\n}, {\r\n    method: \"delete\",\r\n    route: \"/users/:id\",\r\n    controller: UserController,\r\n    action: \"remove\"\r\n}];`;\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the user controller file (used when express is enabled).\r\n     */\r\n    protected static getControllerTemplate(isEsm: boolean): string {\r\n        return `import {getRepository} from \"typeorm\";\r\nimport {NextFunction, Request, Response} from \"express\";\r\nimport {User} from \"../entity/User${isEsm ? \".js\" : \"\"}\";\r\n\r\nexport class UserController {\r\n\r\n    private userRepository = getRepository(User);\r\n\r\n    async all(request: Request, response: Response, next: NextFunction) {\r\n        return this.userRepository.find();\r\n    }\r\n\r\n    async one(request: Request, response: Response, next: NextFunction) {\r\n        return this.userRepository.findOne(request.params.id);\r\n    }\r\n\r\n    async save(request: Request, response: Response, next: NextFunction) {\r\n        return this.userRepository.save(request.body);\r\n    }\r\n\r\n    async remove(request: Request, response: Response, next: NextFunction) {\r\n        let userToRemove = await this.userRepository.findOne(request.params.id);\r\n        await this.userRepository.remove(userToRemove);\r\n    }\r\n\r\n}`;\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the main (index) application file.\r\n     */\r\n    protected static getAppIndexTemplate(express: boolean, isEsm: boolean): string {\r\n        if (express) {\r\n            return `import \"reflect-metadata\";\r\nimport {createConnection} from \"typeorm\";\r\nimport ${!isEsm ? \"* as \" : \"\"}express from \"express\";\r\nimport ${!isEsm ? \"* as \" : \"\"}bodyParser from \"body-parser\";\r\nimport {Request, Response} from \"express\";\r\nimport {Routes} from \"./routes${isEsm ? \".js\" : \"\"}\";\r\nimport {User} from \"./entity/User${isEsm ? \".js\" : \"\"}\";\r\n\r\ncreateConnection().then(async connection => {\r\n\r\n    // create express app\r\n    const app = express();\r\n    app.use(bodyParser.json());\r\n\r\n    // register express routes from defined application routes\r\n    Routes.forEach(route => {\r\n        (app as any)[route.method](route.route, (req: Request, res: Response, next: Function) => {\r\n            const result = (new (route.controller as any))[route.action](req, res, next);\r\n            if (result instanceof Promise) {\r\n                result.then(result => result !== null && result !== undefined ? res.send(result) : undefined);\r\n\r\n            } else if (result !== null && result !== undefined) {\r\n                res.json(result);\r\n            }\r\n        });\r\n    });\r\n\r\n    // setup express app here\r\n    // ...\r\n\r\n    // start express server\r\n    app.listen(3000);\r\n\r\n    // insert new users for test\r\n    await connection.manager.save(connection.manager.create(User, {\r\n        firstName: \"Timber\",\r\n        lastName: \"Saw\",\r\n        age: 27\r\n    }));\r\n    await connection.manager.save(connection.manager.create(User, {\r\n        firstName: \"Phantom\",\r\n        lastName: \"Assassin\",\r\n        age: 24\r\n    }));\r\n\r\n    console.log(\"Express server has started on port 3000. Open http://localhost:3000/users to see results\");\r\n\r\n}).catch(error => console.log(error));\r\n`;\r\n\r\n        } else {\r\n            return `import \"reflect-metadata\";\r\nimport {createConnection} from \"typeorm\";\r\nimport {User} from \"./entity/User${isEsm ? \".js\" : \"\"}\";\r\n\r\ncreateConnection().then(async connection => {\r\n\r\n    console.log(\"Inserting a new user into the database...\");\r\n    const user = new User();\r\n    user.firstName = \"Timber\";\r\n    user.lastName = \"Saw\";\r\n    user.age = 25;\r\n    await connection.manager.save(user);\r\n    console.log(\"Saved a new user with id: \" + user.id);\r\n\r\n    console.log(\"Loading users from the database...\");\r\n    const users = await connection.manager.find(User);\r\n    console.log(\"Loaded users: \", users);\r\n\r\n    console.log(\"Here you can setup and run express/koa/any other framework.\");\r\n\r\n}).catch(error => console.log(error));\r\n`;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the new package.json file.\r\n     */\r\n    protected static getPackageJsonTemplate(projectName?: string, projectIsEsm?: boolean): string {\r\n        return JSON.stringify({\r\n            name: projectName || \"new-typeorm-project\",\r\n            version: \"0.0.1\",\r\n            description: \"Awesome project developed with TypeORM.\",\r\n            type: projectIsEsm ? \"module\" : \"commonjs\",\r\n            devDependencies: {\r\n            },\r\n            dependencies: {\r\n            },\r\n            scripts: {\r\n            }\r\n        }, undefined, 3);\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the new docker-compose.yml file.\r\n     */\r\n    protected static getDockerComposeTemplate(database: string): string {\r\n\r\n        switch (database) {\r\n            case \"mysql\":\r\n                return `version: '3'\r\nservices:\r\n\r\n  mysql:\r\n    image: \"mysql:5.7.10\"\r\n    ports:\r\n      - \"3306:3306\"\r\n    environment:\r\n      MYSQL_ROOT_PASSWORD: \"admin\"\r\n      MYSQL_USER: \"test\"\r\n      MYSQL_PASSWORD: \"test\"\r\n      MYSQL_DATABASE: \"test\"\r\n\r\n`;\r\n            case \"mariadb\":\r\n                return `version: '3'\r\nservices:\r\n\r\n  mariadb:\r\n    image: \"mariadb:10.1.16\"\r\n    ports:\r\n      - \"3306:3306\"\r\n    environment:\r\n      MYSQL_ROOT_PASSWORD: \"admin\"\r\n      MYSQL_USER: \"test\"\r\n      MYSQL_PASSWORD: \"test\"\r\n      MYSQL_DATABASE: \"test\"\r\n\r\n`;\r\n            case \"postgres\":\r\n                return `version: '3'\r\nservices:\r\n\r\n  postgres:\r\n    image: \"postgres:9.6.1\"\r\n    ports:\r\n      - \"5432:5432\"\r\n    environment:\r\n      POSTGRES_USER: \"test\"\r\n      POSTGRES_PASSWORD: \"test\"\r\n      POSTGRES_DB: \"test\"\r\n\r\n`;\r\n            case \"cockroachdb\":\r\n                return `version: '3'\r\nservices:\r\n\r\n  cockroachdb:\r\n    image: \"cockroachdb/cockroach:v2.1.4\"\r\n    command: start --insecure\r\n    ports:\r\n      - \"26257:26257\"\r\n\r\n`;\r\n            case \"sqlite\":\r\n            case \"better-sqlite3\":\r\n                return `version: '3'\r\nservices:\r\n`;\r\n            case \"oracle\":\r\n                throw new TypeORMError(`You cannot initialize a project with docker for Oracle driver yet.`); // todo: implement for oracle as well\r\n\r\n            case \"mssql\":\r\n                return `version: '3'\r\nservices:\r\n\r\n  mssql:\r\n    image: \"microsoft/mssql-server-linux:rc2\"\r\n    ports:\r\n      - \"1433:1433\"\r\n    environment:\r\n      SA_PASSWORD: \"Admin12345\"\r\n      ACCEPT_EULA: \"Y\"\r\n\r\n`;\r\n            case \"mongodb\":\r\n                return `version: '3'\r\nservices:\r\n\r\n  mongodb:\r\n    image: \"mongo:4.0.6\"\r\n    container_name: \"typeorm-mongodb\"\r\n    ports:\r\n      - \"27017:27017\"\r\n\r\n`;\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * Gets contents of the new readme.md file.\r\n     */\r\n    protected static getReadmeTemplate(options: { docker: boolean }): string {\r\n        let template = `# Awesome Project Build with TypeORM\r\n\r\nSteps to run this project:\r\n\r\n1. Run \\`npm i\\` command\r\n`;\r\n\r\n        if (options.docker) {\r\n            template += `2. Run \\`docker-compose up\\` command\r\n`;\r\n        } else {\r\n            template += `2. Setup database settings inside \\`ormconfig.json\\` file\r\n`;\r\n        }\r\n\r\n        template += `3. Run \\`npm start\\` command\r\n`;\r\n        return template;\r\n    }\r\n\r\n    /**\r\n     * Appends to a given package.json template everything needed.\r\n     */\r\n    protected static appendPackageJson(packageJsonContents: string, database: string, express: boolean, projectIsEsm: boolean /*, docker: boolean*/): string {\r\n        const packageJson = JSON.parse(packageJsonContents);\r\n\r\n        if (!packageJson.devDependencies) packageJson.devDependencies = {};\r\n        Object.assign(packageJson.devDependencies, {\r\n            \"ts-node\": \"10.4.0\",\r\n            \"@types/node\": \"^16.11.10\",\r\n            \"typescript\": \"4.5.2\"\r\n        });\r\n\r\n        if (!packageJson.dependencies) packageJson.dependencies = {};\r\n        Object.assign(packageJson.dependencies, {\r\n            \"typeorm\": require(\"../package.json\").version,\r\n            \"reflect-metadata\": \"^0.1.13\"\r\n        });\r\n\r\n        switch (database) {\r\n            case \"mysql\":\r\n            case \"mariadb\":\r\n                packageJson.dependencies[\"mysql\"] = \"^2.14.1\";\r\n                break;\r\n            case \"postgres\":\r\n            case \"cockroachdb\":\r\n                packageJson.dependencies[\"pg\"] = \"^8.4.0\";\r\n                break;\r\n            case \"sqlite\":\r\n                packageJson.dependencies[\"sqlite3\"] = \"^4.0.3\";\r\n                break;\r\n            case \"better-sqlite3\":\r\n                packageJson.dependencies[\"better-sqlite3\"] = \"^7.0.0\";\r\n                break;\r\n            case \"oracle\":\r\n                packageJson.dependencies[\"oracledb\"] = \"^1.13.1\";\r\n                break;\r\n            case \"mssql\":\r\n                packageJson.dependencies[\"mssql\"] = \"^4.0.4\";\r\n                break;\r\n            case \"mongodb\":\r\n                packageJson.dependencies[\"mongodb\"] = \"^3.0.8\";\r\n                break;\r\n        }\r\n\r\n        if (express) {\r\n            packageJson.dependencies[\"express\"] = \"^4.17.2\";\r\n            packageJson.dependencies[\"body-parser\"] = \"^1.19.1\";\r\n        }\r\n\r\n        if (!packageJson.scripts) packageJson.scripts = {};\r\n\r\n        if (projectIsEsm)\r\n            Object.assign(packageJson.scripts, {\r\n                start: /*(docker ? \"docker-compose up && \" : \"\") + */\"node --loader ts-node/esm src/index.ts\",\r\n                typeorm: \"node --loader ts-node/esm ./node_modules/typeorm/cli.js\"\r\n            });\r\n        else\r\n            Object.assign(packageJson.scripts, {\r\n                start: /*(docker ? \"docker-compose up && \" : \"\") + */\"ts-node src/index.ts\",\r\n                typeorm: \"node --require ts-node/register ./node_modules/typeorm/cli.js\"\r\n            });\r\n\r\n        return JSON.stringify(packageJson, undefined, 3);\r\n    }\r\n\r\n}\r\n"],"sourceRoot":".."}