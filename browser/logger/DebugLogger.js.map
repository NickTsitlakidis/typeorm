{"version":3,"sources":["../browser/src/logger/DebugLogger.ts"],"names":[],"mappings":"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","file":"DebugLogger.js","sourcesContent":["import debug from \"debug\"\r\nimport { Logger } from \"./Logger\"\r\nimport { QueryRunner } from \"../query-runner/QueryRunner\"\r\nimport { PlatformTools } from \"../platform/PlatformTools\"\r\n\r\n/**\r\n * Performs logging of the events in TypeORM via debug library.\r\n */\r\nexport class DebugLogger implements Logger {\r\n    private debugQueryLog = debug(\"typeorm:query:log\")\r\n    private debugQueryError = debug(\"typeorm:query:error\")\r\n    private debugQuerySlow = debug(\"typeorm:query:slow\")\r\n    private debugSchemaBuild = debug(\"typeorm:schema\")\r\n    private debugMigration = debug(\"typeorm:migration\")\r\n\r\n    private debugLog = debug(\"typeorm:log\")\r\n    private debugInfo = debug(\"typeorm:info\")\r\n    private debugWarn = debug(\"typeorm:warn\")\r\n\r\n    /**\r\n     * Logs query and parameters used in it.\r\n     */\r\n    logQuery(query: string, parameters?: any[], queryRunner?: QueryRunner) {\r\n        if (this.debugQueryLog.enabled) {\r\n            this.debugQueryLog(PlatformTools.highlightSql(query) + \";\")\r\n            if (parameters && parameters.length) {\r\n                this.debugQueryLog(\"parameters:\", parameters)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Logs query that failed.\r\n     */\r\n    logQueryError(\r\n        error: string,\r\n        query: string,\r\n        parameters?: any[],\r\n        queryRunner?: QueryRunner,\r\n    ) {\r\n        if (this.debugQueryError.enabled) {\r\n            this.debugQueryError(PlatformTools.highlightSql(query) + \";\")\r\n            if (parameters && parameters.length) {\r\n                this.debugQueryError(\"parameters:\", parameters)\r\n            }\r\n            this.debugQueryError(\"error: \", error)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Logs query that is slow.\r\n     */\r\n    logQuerySlow(\r\n        time: number,\r\n        query: string,\r\n        parameters?: any[],\r\n        queryRunner?: QueryRunner,\r\n    ) {\r\n        if (this.debugQuerySlow.enabled) {\r\n            this.debugQuerySlow(PlatformTools.highlightSql(query) + \";\")\r\n            if (parameters && parameters.length) {\r\n                this.debugQuerySlow(\"parameters:\", parameters)\r\n            }\r\n            this.debugQuerySlow(\"execution time:\", time)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Logs events from the schema build process.\r\n     */\r\n    logSchemaBuild(message: string, queryRunner?: QueryRunner) {\r\n        if (this.debugSchemaBuild.enabled) {\r\n            this.debugSchemaBuild(message)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Logs events from the migration run process.\r\n     */\r\n    logMigration(message: string, queryRunner?: QueryRunner) {\r\n        if (this.debugMigration.enabled) {\r\n            this.debugMigration(message)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Perform logging using given logger.\r\n     * Log has its own level and message.\r\n     */\r\n    log(\r\n        level: \"log\" | \"info\" | \"warn\",\r\n        message: any,\r\n        queryRunner?: QueryRunner,\r\n    ) {\r\n        switch (level) {\r\n            case \"log\":\r\n                if (this.debugLog.enabled) {\r\n                    this.debugLog(message)\r\n                }\r\n                break\r\n            case \"info\":\r\n                if (this.debugInfo.enabled) {\r\n                    this.debugInfo(message)\r\n                }\r\n                break\r\n            case \"warn\":\r\n                if (this.debugWarn.enabled) {\r\n                    this.debugWarn(message)\r\n                }\r\n                break\r\n        }\r\n    }\r\n}\r\n"],"sourceRoot":".."}